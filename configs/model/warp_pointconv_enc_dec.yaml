_target_: src.models.networks.warp.litmodule.WarpLitModule

net:
  _target_: src.models.networks.warp.point_convnet.PointConvEncoderDecoderToCLIP
  _partial_: true

  # warp.convnet.models.point_conv_unet.PointConvEncoderDecoder
  backbone_cfg:
    in_channels: 6
    out_channels: 192
    encoder_channels: [16, 32, 48, 64, 80, 96, 112, 128, 144]
    decoder_channels: [144, 160, 172, 192, 192]
    num_encoder_blocks_per_level: [1, 1, 1, 1, 1, 1, 1, 1]
    num_decoder_blocks_per_level: [1, 1, 1, 1]
    # neighbor search args
    neighbor_search_args:
      _target_: warp.convnet.geometry.ops.neighbor_search_continuous.NeighborSearchArgs
      mode: radius
    neighbor_search_radii: [0.1, 0.15, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7]
    # pooling args
    pooling_args:
      _target_: warp.convnet.geometry.ops.point_pool.FeaturePoolingArgs
      pooling_mode: reductions
    downsample_voxel_sizes: [0.05, 0.075, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35]
    num_levels_enc: 8
    num_levels_dec: 4

  # last mlp
  adapter_cfg:
    in_channel: ${model.net.backbone_cfg.out_channels}
    text_channel: 512
    last_norm: true
    normalize_output: true

compile: false
